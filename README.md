## 컨테이너







## 쿠버네티스

컨테이너의 특징 중 서버의 자원을 효율적으로 사용 할 수 있는 이점이 있어서 기업에서는 컨테이너를 찾기 시작했다.
컨테이너가 엄청나게 많아지게 된다면 무슨일이 생겨날까?

운영자들은 엄청난 컨테이너의 쓰나미로 멘탈이 붕되는 혼란을 야기 할 것이다.
컨테이너들의 관리와 운영이 어려워져서 오히려 운영상의 효율성이 떨어지게 되고, 결국에 다시 가상머신(VM)으로 회귀하는 현상이 발생 할 것이다.

이러한 관리와 운영상의 문제로 갈팡질팡 하던차에 한줄기의 구세주와 같이 등장한 플랫폼이 바로 쿠버네티스(Kubernetes)이다.

결국에는 정리하자면, 쿠버네티스(Kubernetes)는 컨테이너 오케스트레이션 플랫폼 중 하나로, 수 많은 컨테이너들을 관리, 모니터링, 스케쥴링을 도와주는 플랫폼으로, 구글이 자사 서비스를 위해 2014년도에 개발했던 [Borg](https://kubernetes.io/blog/2015/04/borg-predecessor-to-kubernetes/)에서 얻은 운영 노하우를 오픈소스로 공개한 서비스이다.



### 쿠버네티스의 장점

> 항상 어딜 가든 물어보는 단골 질문이다. "쿠버네티스 왜 써요?", "이거 쓰면 뭐가 좋아요?" 이제 그걸 알아보자.

#### 1. 무중단 (Fault tolerance - FT) 서비스 제공

때때로 어느 기업의 서비스를 사용하고 싶어서 보면 "서비스 개선을 위한 임시점검" 이라는 안내문이 나와서 짜증나는 경우를 겪었던 적이 있을 것이다.(체감상 하나도 개선이 안됬지만)

이런 상황인 경우 보통 기업에서는 개발자들이나 운영자들이 서버 업데이트를 위해서 사용자들이 잠든 새벽 시간대를 활용하거나, 긴급 점검의 형태로 서비스 일시 중단을 하고 죽어라 업데이트를 했지만, 쿠버네티스는 점진적 업데이트를 제공하기 때문에 서비스를 중단하지 않고도 어플리케이션을 업데이트 할 수 있다.

또한, 쿠버네티스는 자가 복구 (Self Healing) 기능을 제공하기 때문에 특정 컨테이너에 갑작스러운 장애 현상이 발생하더라도 곧 바로 복제 컨테이너를 생성해서 서비스 유지를 도와줄 수 있는 운영상 아름다룬 플랫폼이다.

#### 2. Vendor Lock In 해결

가끔씩이 아니라 은근 많은 고객들이 A사의 클라우드를 사용하다가 C사의 클라우드로 환경을 이전하고 싶어할 때가 있다.

이런 경우 서로 다른 업체 (Vendor)의 클라우드 제품 간에 호환 문제가 발생하여 이전하기 어려운 상황을  Vendor Lock In이라고 하는데 이런경우 아무리 어르고 달래도 고객사는 마치 아따아따의 단비 마냥 때를 쓰며 해달라고 하는 경우가 많다. 

하지만! 쿠버네티스는 도커 컨테이너 기반으로 하는 오픈소스이기 때문에 사용자들이 특정 업체에 종속되지 않고 클라우드 환경을 손쉽게 이전할 수 있다.

#### 3. 애플리케이션 배포의 단순화

개발자가 운영자의 도움이나 서버에 대한 별도의 지식 없이 자체적으로 애플리케이션을 배포할 수 있게 된다. 쿠버네티스 클러스터의 노드는 수많은 베어메탈 서버 혹은 VM으로 구성되어 있을지라도 배포를 기다리는 애플리케이션 입장에서는 하나의 거대한 서버이다. 

개발자는 컨테이너화 된 애플리케이션을 인프라 구성에 대한 정보 없이도 손쉽게 배포할 수 있다. 또한 쿠버네티스 환경에서는 rolling upgrade, blue-green 배포 등을 간단하게 실행할 수 있다.

#### 4. 애플리케이션 개발의 단순화

개발 환경과 운영 환경이 동일한 환경(컨테이너)에서 애플리케이션이 구동된다는 보장을 갖게 된다. 개발자는 환경 차이에 따른 추가적인 고민을 할 필요가 없게 된다. java로 동작하는 애플리케이션을 배포하기 위해서 클러스터의 어떤 node에도 java가 설치되어 있을 필요가 없으며, 추가적인 수많은 환경 설정들도 신경쓸 필요가 없다. 어떤 노드에 애플리케이션이 배포되더라도 애플리케이션은 빌드한 컨테이너의 java와 환경 설정을 동일하게 가져간다.

또한 개발자가 고려해야 하는 복잡한 기능들 (피어 검색, 리소스 락을 위한 인스턴스 리더 선정 등)을 구현할 필요 없이 쿠버네티스를 활용할 수 있다.

#### 5. 컴퓨팅 리소스 활용

쿠버네티스는 배포할 애플리케이션이 요구하는 리소스 등을 고려해 배포될 노드를 자동으로 선택해 준다. 쿠버네티스는 빠르고 효율적으로 수백, 수천개의 노드의 자원 상황에 따라 애플리케이션을 적재 적소에 배포할 수 있게 된다. 이를 통해 낭비되는 자원을 최소화 할 수 있으며 개발자, 인프라 운영자의 수고도 최소화 할 수 있다.

#### 6. 지속적인 상태 확인과 셀프 힐링

쿠버네티스는 배포된 애플리케이션의 구성 요소들과 노드를 지속적으로 모니터링 한다. 컨테이너에 문제가 발생하거나 노드에 장애가 발생할 경우 자동으로 해당 애플리케이션 컨테이너를 문제가 없는 다른 적당한 노드로 스케쥴링해 다시 구동시켜준다. 컨테이너 특성상 재구동이 매우 빠르게 이루어지며 운영자의 모니터링 없이도 장애에 자동으로 대응할 수 있게 된다.

#### 7. 오토스케일링

특정 컨테이너에 부하가 급격하게 발생할 경우, 쿠버네티스는 이를 모니터링 하고 있다가 정해진 수준 이상으로 부하 발생시 자동으로 스케일 아웃하여 컨테이너를 늘려서 부하를 분산시켜준다. 사용이 줄어 부하가 감소하면 쿠버네티스는 다시 이전 수준으로 감소시켜 준다.

이를 통해 급격한 부하 증가에 따른 장애를 방지할 수 있으며, 스케일 아웃을 위해 미리 거대한 자원을 확보해 둘 필요가 없기 때문에 비용적인 측면 역시 많은 효과를 볼 수 있다.



